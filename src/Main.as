package {	import flash.display.Sprite;	import flash.display.StageAlign;	import flash.events.Event;	import flash.events.ErrorEvent;	import flash.events.MouseEvent;	import flash.net.navigateToURL;	import flash.net.URLRequest;	import flash.text.StyleSheet;	import flash.text.TextField;	import net.peteshand.utils.Popup;	import net.peteshand.utils.PopupOptionsVO;	import net.peteshand.utils.Window;	import net.peteshand.utils.WindowEvent;		/**	 * ...	 * @author Pete Shand	 */	public class Main extends Sprite 	{		private var main:mcMain;		private var currentWindow:Window;				public function Main():void 		{			if (stage) init();			else addEventListener(Event.ADDED_TO_STAGE, init);		}				private function init(e:Event = null):void 		{						removeEventListener(Event.ADDED_TO_STAGE, init);						main = new mcMain();			addChild(main);						main.btn_openPopup.addEventListener(MouseEvent.CLICK, ClickOpenPopup);			main.btn_htmlInjection.addEventListener(MouseEvent.CLICK, ClickHtmlInjection);			main.btn_closeAll.addEventListener(MouseEvent.CLICK, ClickCloseAll);						main.btn_setWindowPosition.addEventListener(MouseEvent.CLICK, ClickSetWindowPosition);			main.btn_getWindowPosition.addEventListener(MouseEvent.CLICK, ClickGetWindowPosition);						main.btn_setWindowDimensions.addEventListener(MouseEvent.CLICK, ClickSetWindowDimensions);			main.btn_changeAlignment.addEventListener(MouseEvent.CLICK, ClickChangeAlignment);					}				private var alignmentIndex:int = 0;		private var alignments:Array = new Array(	StageAlign.TOP_LEFT, StageAlign.TOP, StageAlign.TOP_RIGHT,													StageAlign.LEFT, "M", StageAlign.RIGHT,													StageAlign.BOTTOM_LEFT, StageAlign.BOTTOM, StageAlign.BOTTOM_RIGHT);				private function ClickChangeAlignment(e:MouseEvent):void 		{			if (currentWindow != null) {				currentWindow.align = alignments[alignmentIndex];								alignmentIndex++;				if (alignmentIndex >= alignments.length) {					alignmentIndex = 0;				}			}		}				private function ClickSetWindowDimensions(e:MouseEvent):void 		{			if (currentWindow != null) {				currentWindow.width = int(main.txt_setWidth.text);				currentWindow.height = int(main.txt_setHeight.text);			}		}				private function ClickSetWindowPosition(e:MouseEvent):void 		{			if (currentWindow != null) {				currentWindow.x = int(main.txt_setX.text);				currentWindow.y = int(main.txt_setY.text);			}		}		private function ClickGetWindowPosition(e:MouseEvent):void 		{			if (currentWindow != null) {				main.txt_displayXY.text = currentWindow.x + " : " + currentWindow.y + " : " + currentWindow.width + " : " + currentWindow.height;			}		}				private function ClickOpenPopup(e:MouseEvent):void 		{			trace('BaseJSInjected = '  + Popup.BaseJSInjected);			var options:PopupOptionsVO = new PopupOptionsVO();			options.x = 10;			options.y = 10;			options.width = 400;			options.height = 300;			//options.align = StageAlign.BOTTOM_RIGHT;			currentWindow = Popup.Open("index.html", options);			currentWindow.addEventListener(WindowEvent.MOVE, OnMove);			currentWindow.addEventListener(WindowEvent.RESIZE, OnResize);			currentWindow.addEventListener(WindowEvent.CLOSE, OnClose);						trace('BaseJSInjected = '  + Popup.BaseJSInjected);		}		private function ClickHtmlInjection(e:MouseEvent):void 		{			var options:PopupOptionsVO = new PopupOptionsVO();			options.x = 200;			options.y = 100;			options.align = StageAlign.BOTTOM_RIGHT;			options.callback = CallBack;						function CallBack(...rest):void			{				trace('rest = ' + rest);			}						var css:StyleSheet = new StyleSheet();			css.setStyle("body", { margin:'5px' } );			css.setStyle("h1", {fontFamily:'Arial, Helvetica, sans-serif',fontSize:'16px',fontWeight:'bold',color:'#F00',margin:'0px'});			css.setStyle("p", {fontFamily:'Arial, Helvetica, sans-serif',fontSize:'16px',color:'#00F',margin:'0px'});			css.setStyle("#imgDiv", { backgroundColor:'#F00', width:'40px', height:'40px', minHeight:'40px', float:'left' } );			css.setStyle("#copyDiv", { float:'left', marginLeft:'5px' } );						var onClickJS:String = "asPopup.callback(['test','test2']);";						currentWindow = Popup.HtmlInjection('<div onclick=' + onClickJS + ' id="imgDiv"></div><div id="copyDiv"><h1>Title</h1><p>body copy</p></div>', options, 0, css);			currentWindow.addEventListener(WindowEvent.MOVE, OnMove);			currentWindow.addEventListener(WindowEvent.RESIZE, OnResize);			currentWindow.addEventListener(WindowEvent.CLOSE, OnClose);		}		private function OnMove(e:WindowEvent):void 		{			trace('p = ' + currentWindow.x + " : " + currentWindow.y);		}		private function OnResize(e:WindowEvent):void 		{			trace('d = ' + currentWindow.width + " : " + currentWindow.height);		}		private function OnClose(e:WindowEvent):void 		{			trace('closed');		}		private function ClickCloseAll(e:MouseEvent):void 		{			Popup.CloseAll();		}	}	}